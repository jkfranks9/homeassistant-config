#=======================#
#     Reminder Card     #
#=======================#

# Next event is for tasks that occur on a regular basis, such as changing an HVAC filter every 
# 4 months.
next_event:
  default:
    - amount: ''
  card:
    type: entities
    entities:
      - type: 'custom:multiple-entity-row'
        entity: '[[entity]]'
        icon: 'mdi:[[icon]]'
        name: '[[name]]'
        secondary_info: '[[interval]] [[period]] [[amount]]'
        hold_action:
          action: call-service
          service: '[[service]]'
          service_data:
            entity: '[[entity]]'
            interval: '[[interval]]'
    
    style: |
      {% if states.input_datetime | count > 0 %}
        {%- set ts_event = as_timestamp(states.[[entity]].state, default=0) %}
        {%- set ts_now = as_timestamp(now())|round(0) %}
        {%- set ts_delta = (ts_now - ts_event) %}
      {% else %}
        {% set ts_delta = (-86400) %}
      {% endif %}
      ha-card {
        color: {% if (ts_delta >= 0) %}red {% elif ts_delta > (-86400) %}yellow {% else %}var(--primary-text-color) {% endif %};
      }

#==================#
#     Bar Card     #
#==================#

severity_colors:
  default:
    - min: 0
    - max: 100
  card:
    type: custom:bar-card
    name: '[[name]]'
    entity: '[[entity]]'
    icon: '[[icon]]'
    entity_row: true
    height: 30px
    min: '[[min]]'
    max: '[[max]]'
    severity:
      - color: 'var(--bar-low-color)'
        from: '[[range1_from]]'
        to:   '[[range1_to]]'
      - color: 'var(--bar-medium-color)'
        from: '[[range2_from]]'
        to:   '[[range2_to]]'
      - color: 'var(--bar-high-color)'
        from: '[[range3_from]]'
        to:   '[[range3_to]]'
