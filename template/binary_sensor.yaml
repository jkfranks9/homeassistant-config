#========================#
#     Binary Sensors     #
#========================#

- binary_sensor:

    #-----------------------------#
    #   -- Amazon Smart Plug --   #
    #-----------------------------#
    
    # See the input boolean of the same name for details on how this works.
    - name: 'Alexa HA - Office Bookcase'
      unique_id: alexa_ha_plug
      device_class: garage_door
      state: "{{ is_state('input_boolean.alexa_ha_plug', 'on') }}"

    #-----------------------------#
    #   -- Floorplan Mirrors --   #
    #-----------------------------#

    # These sensors are used to create mirror entities to items on the floorplan. For example,
    # there are four wall sconces in the theater, but the floorplan card only allows one element
    # in the SVG file with a given entity ID. By having sensors that mirror that one entity's
    # state, we can then place elements in the SVG file using those sensor IDs.    
    - name: 'Driveway Lights Mirror'
      unique_id: driveway_lights_mirror
      device_class: light
      state: "{{ is_state('switch.driveway_lights', 'on') }}"
    
    - name: 'Garage Lights Mirror'
      unique_id: garage_lights_mirror
      device_class: light
      state: "{{ is_state('switch.garage_lights', 'on') }}"
    
    - name: 'Mantle Bookcase Mirror'
      unique_id: mantle_bookcase_mirror
      device_class: light
      state: "{{ is_state('switch.mantle_bookcase', 'on') }}"
    
    - name: 'Snack Light Mirror'
      unique_id: snack_light_mirror
      device_class: light
      state: "{{ is_state('switch.snack_light', 'on') }}"
      
    - name: 'Theater Sconces Mirror'
      unique_id: theater_sconces_mirror
      device_class: light
      state: "{{ is_state('light.theater_sconces', 'on') }}"
    
    - name: 'Theater Ceiling Mirror'
      unique_id: theater_ceiling_mirror
      device_class: light
      state: "{{ is_state('light.theater_ceiling', 'on') }}"
    
    - name: 'Upstairs Bedroom Light Mirror'
      unique_id: upstairs_bedroom_light_mirror
      device_class: light
      state: "{{ is_state('switch.upstairs_bedroom_light', 'on') }}"
    
    - name: 'Upstairs Hallway Lights Mirror'
      unique_id: upstairs_hallway_lights_mirror
      device_class: light
      state: "{{ is_state('switch.upstairs_hallway_lights', 'on') }}"

    #-------------------------#
    #   -- History Stats --   #
    #-------------------------#
    
    # These sensors are used to support history stats.
    
    # Family Room AV is true if the associated device is drawing power, and a grandchild
    # is not home or a grandchild is home and it's in the evening (I don't count a grandchild
    # watching YouTube or cartoon shows all day).
    - name: 'Family Room AV'
      unique_id: family_room_av
      state: >
        {{ states('sensor.sonoff_family_room_av_power') | float(0) > 10 and
           (is_state('input_boolean.grandchild_home', 'off') or
             (is_state('input_boolean.grandchild_home', 'on') and
              now().strftime('%H') > '7')) }}
    
    # Cinema is true if the projector is drawing power, and the source device is not Shield TV
    # (we can't know if such devices are playing or not) or the source is Shield TV and it's in
    # playing state.
    - name: 'Cinema Projector'
      unique_id: cinema_projector
      state: >
        {{ states('sensor.projector_power') | float(0) > 0  and
           (is_state('switch.harmony_hub_stream_player', 'off') or
             (is_state('switch.harmony_hub_stream_player', 'on') and
              is_state('media_player.shield_tv', 'playing'))) }}
